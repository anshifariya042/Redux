//store.js

import {createSlice,configureStore} from '@reduxjs/toolkit'
const todoSlice=createSlice({
  name:'todo',
  initialState:{
    todos:[],
  },
  reducers:{
    addTodo:(state,action)=>{
      state.todos.push({
        id:Date.now(),
      completed:false,
      text:action.payload
      })
    },
    deleteTodo:(state,action)=>{
      state.todos=state.todos.filter((t)=>t.id !==action.payload)
    },
    toggleTodo:(state,action)=>{
      const todo=state.todos.find((t)=>t.id === action.payload);
      if (todo) todo.completed =! todo.completed;
    },
    editTodo:(state,action)=>{
      const {id,newText}=action.payload;
      const todo=state.todos.find((t)=>t.id === id);
      if (todo) todo.text=newText;
    }
  }
});
export const {addTodo,deleteTodo,editTodo,toggleTodo}=todoSlice.actions;
const store=configureStore({
  reducer:{
    todo:todoSlice.reducer
  }
});

export default store;    


//App.js

import React,{useState} from 'react'
import { addTodo, deleteTodo, editTodo, toggleTodo } from './store';
import {useSelector,useDispatch} from 'react-redux'


function App() {
     const [task,setTask]= useState('');
     const [edited,setEdited]=useState(null);
     const [editText,setEditText]=useState('');

     const todoo=useSelector((state)=>state.todo.todos);
     const dispatch=useDispatch();

     const add=()=>{
        if(task.trim()){
        dispatch(addTodo(task));
        setTask('');
     }
    }

     const edit=(id)=>{
        if(editText.trim()){
        dispatch(editTodo({id,newText:editText}));
        setEditText('');
        setEdited(null);
     }
    }
  return (
    <div>
        <input
        type='text'
        value={task}
        onChange={(e)=>setTask(e.target.value)}
        />
        <button onClick={add}>add</button>
 
        <ul>
            {todoo.map((t)=>(
                <li key={t.id}>{edited===t.id? 
                (
                <>
                <input
                type='text'
                value={editText}
                onChange={(e)=>setEditText(e.target.value)}
                />
                <button onClick={()=>edit(t.id)}>save</button>
                <button onClick={()=>setEdited(null)}>cancel</button>
                </>
                ):(
                    <>
                    <span onClick={()=>dispatch(toggleTodo(t.id))}>{t.text}</span>
                    <button onClick={()=>{
                        setEditText(t.text)
                        setEdited(t.id)
                    }} >edit</button>
                    <button onClick={()=>dispatch(deleteTodo(t.id))}>delete</button>
                    </>
                )

                }
                </li>
            ))}
        </ul>
        
      
    </div>
  )
}

export default App

//main.js

import React from 'react';
import ReactDOM from 'react-dom/client';
import { Provider } from 'react-redux';
import App from './App';
import store from './store';

ReactDOM.createRoot(document.getElementById('root')).render(
  <Provider store={store}>
    <App />
  </Provider>
);
